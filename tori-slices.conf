# TORI Service Slice Configuration
# Place in /etc/systemd/system/tori.slice

[Unit]
Description=TORI Application Resource Slice
Documentation=https://github.com/tori/dickbox
Before=slices.target

[Slice]
# Default resource limits for all TORI services
# These can be overridden per-service

# CPU limits
CPUWeight=100
CPUQuota=80%

# Memory limits  
MemoryMax=32G
MemoryHigh=24G
MemoryLow=8G
MemorySwapMax=4G

# IO limits
IOWeight=100
IOReadBandwidthMax=/dev/sda 100M
IOWriteBandwidthMax=/dev/sda 100M

# Task limits
TasksMax=4096

# Per-service slice templates:
# Create these as needed for different workload types

---

# High-priority inference slice
# /etc/systemd/system/tori-inference.slice

[Unit]
Description=TORI GPU Inference Slice
Documentation=https://github.com/tori/dickbox

[Slice]
# High CPU priority for real-time inference
CPUWeight=200
CPUQuota=90%

# Generous memory for model loading
MemoryMax=64G
MemoryHigh=48G

# Fast IO for model loading
IOWeight=200

---

# Background batch processing slice  
# /etc/systemd/system/tori-batch.slice

[Unit]
Description=TORI Batch Processing Slice
Documentation=https://github.com/tori/dickbox

[Slice]
# Lower priority than inference
CPUWeight=50
CPUQuota=40%

# Limited memory to prevent OOM
MemoryMax=8G
MemoryHigh=6G

# Lower IO priority
IOWeight=50

---

# Development/build slice
# /etc/systemd/system/tori-build.slice

[Unit] 
Description=TORI Build Tasks Slice
Documentation=https://github.com/tori/dickbox

[Slice]
# Very low priority
CPUWeight=10
CPUQuota=20%

# Moderate memory
MemoryMax=4G

# Minimal IO
IOWeight=10

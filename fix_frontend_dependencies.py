#!/usr/bin/env python3\n\"\"\"\n🔧 Frontend Dependency Fixer\nInstalls missing dependencies for TORI frontend\n\"\"\"\n\nimport subprocess\nimport sys\nimport json\nfrom pathlib import Path\n\ndef run_command(cmd, cwd=None):\n    \"\"\"Run a command and return success status\"\"\"\n    try:\n        result = subprocess.run(cmd, shell=True, cwd=cwd, capture_output=True, text=True)\n        if result.returncode == 0:\n            print(f\"✅ {cmd}\")\n            return True\n        else:\n            print(f\"❌ {cmd}\")\n            print(f\"Error: {result.stderr}\")\n            return False\n    except Exception as e:\n        print(f\"❌ {cmd} - Exception: {e}\")\n        return False\n\ndef main():\n    print(\"🔧 TORI Frontend Dependency Fixer\")\n    print(\"=\" * 50)\n    \n    # Get frontend directory\n    frontend_dir = Path(__file__).parent / \"tori_ui_svelte\"\n    \n    if not frontend_dir.exists():\n        print(f\"❌ Frontend directory not found: {frontend_dir}\")\n        return 1\n    \n    print(f\"📂 Working in: {frontend_dir}\")\n    \n    # Check if package.json exists\n    package_json = frontend_dir / \"package.json\"\n    if not package_json.exists():\n        print(f\"❌ package.json not found: {package_json}\")\n        return 1\n    \n    # Install missing mathjs dependency\n    print(\"\\n📦 Installing missing dependencies...\")\n    \n    dependencies_to_install = [\n        \"mathjs\",  # For dynamics analysis\n        \"@types/mathjs\"  # TypeScript types\n    ]\n    \n    success_count = 0\n    for dep in dependencies_to_install:\n        print(f\"\\n📦 Installing {dep}...\")\n        if run_command(f\"npm install {dep}\", cwd=frontend_dir):\n            success_count += 1\n    \n    print(f\"\\n📊 Installed {success_count}/{len(dependencies_to_install)} dependencies\")\n    \n    # Verify the dependencies are now in package.json\n    print(\"\\n🔍 Verifying installation...\")\n    try:\n        with open(package_json, 'r') as f:\n            package_data = json.load(f)\n        \n        all_deps = {**package_data.get('dependencies', {}), **package_data.get('devDependencies', {})}\n        \n        for dep in ['mathjs']:\n            if dep in all_deps:\n                print(f\"✅ {dep} version {all_deps[dep]}\")\n            else:\n                print(f\"❌ {dep} not found in package.json\")\n    \n    except Exception as e:\n        print(f\"⚠️ Could not verify package.json: {e}\")\n    \n    # Try to start dev server to test\n    print(\"\\n🧪 Testing frontend compilation...\")\n    print(\"Note: This will start the dev server - press Ctrl+C to stop\")\n    print(\"If compilation succeeds, the mathjs import issue should be resolved.\")\n    \n    print(\"\\n✅ Dependencies installed!\")\n    print(\"\\n🚀 Next steps:\")\n    print(\"1. Try starting the frontend: cd tori_ui_svelte && npm run dev\")\n    print(\"2. Or start the full TORI system: python enhanced_launcher.py\")\n    \n    return 0\n\nif __name__ == \"__main__\":\n    sys.exit(main())\n"